<%- include("../../partials/header.ejs") %>
<%- include("../../partials/navbar.ejs") %>

<div class="container">
    <hr>
    <div class="card">
        <div class="card-header">
            <h2>Atualizar Peça</h2>
        </div>
        <div class="card-body">
            <form method="POST" action="/parts/update">
                <label>Nome:</label><input class="form-control" type="text" name="name" placeholder="Defina o nome para a peça" value="<%= part.name %>"><br>
                <label>Fornecedor:</label><input class="form-control" type="text" name="seller" placeholder="Defina o nome do fornecedor" value="<%= part.seller %>"><br>
                <label>Valor R$:</label><input class="form-control" type="number" step="0.01" name="value" placeholder="0000,00" value="<%= part.value.toFixed(2) %>"><br>
                <label style="padding-right: 22px;">Tipo de peça:</label><br>
                <select name="type" id="type" class="form-control-sm">
                    <% types.forEach((type) => { %>
                        <option value="<%= type.id %>" <%= part.typeId == type.id ? "selected" : "" %>><%= type.name %></option>
                    <% }) %>
                    <option value="novo">Adicionar um novo</option>
                </select>
                    <div id="newType" style="display:none;padding-top:10px">
                        <input type="text" class="form-control-sm" name="newType" placeholder="Digite o novo tipo">
                    </div>
                    <br><br>
                <label>Compatíbilidade:</label><br>
                <select name="compatibility" id="compatibility" class="form-control-sm">
                    <% compatibilities.forEach((compatibility) => { %>
                        <option value="<%= compatibility.id %>" <%= part.compatibilityId == compatibility.id ? "selected" : "" %>><%= compatibility.name %></option>
                    <% }) %>
                    <option value="novo">Adicionar um novo</option>
                </select>
                <div id="newCompatibility" style="display:none;padding-top:10px">
                    <input type="text" class="form-control-sm" name="newCompatibility" placeholder="Digite a nova marca">
                </div>
                <br><br>
                <input type="hidden" name="id" value="<%= part.id %>">
                <button class="btn btn-success">Atualizar</button>
            </form>
        </div>
    </div>
</div>
<script>
    document.getElementById('type').addEventListener('change', function() {
      if (this.value === 'novo') {
        document.getElementById('newType').style.display = 'block';
      } else {
        document.getElementById('newType').style.display = 'none';
      }
    });
  
    document.getElementById('compatibility').addEventListener('change', function() {
      if (this.value === 'novo') {
        document.getElementById('newCompatibility').style.display = 'block';
      } else {
        document.getElementById('newCompatibility').style.display = 'none';
      }
    });
  </script>
<%- include("../../partials/footer.ejs") %>